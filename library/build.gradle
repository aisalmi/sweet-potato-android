apply plugin: "com.android.library"
apply plugin: "kotlin-android"
apply plugin: "kotlin-android-extensions"
apply plugin: "kotlin-kapt"
apply plugin: "com.novoda.bintray-release"
apply plugin: "maven"
apply plugin: "maven-publish"

android
{
  compileSdkVersion 29

  defaultConfig
  {
    minSdkVersion 19
    targetSdkVersion 29

    versionCode 20
    versionName "1.0.0.006-SNAPSHOT"

    sourceSets
    {
      main.java.srcDirs += "src/main/kotlin"
    }
  }

  dataBinding
  {
    enabled = true
  }

  buildTypes
  {
    release
    {
      minifyEnabled false
      zipAlignEnabled true
      proguardFiles getDefaultProguardFile("proguard-android.txt"), "proguard-rules.pro"
    }
  }

  android
  {
    compileOptions
    {
      sourceCompatibility JavaVersion.VERSION_1_8
      targetCompatibility JavaVersion.VERSION_1_8
    }
  }
}

dependencies
{
  // Kotlin
  implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version"
  implementation "org.jetbrains.kotlin:kotlin-reflect:$kotlin_version"

  // Coroutines
  api "org.jetbrains.kotlinx:kotlinx-coroutines-core:$coroutines_version"
  api "org.jetbrains.kotlinx:kotlinx-coroutines-android:$coroutines_version"

  // Androidx
  api "androidx.core:core-ktx:1.1.0"
  api "androidx.appcompat:appcompat:1.1.0"
  api "androidx.localbroadcastmanager:localbroadcastmanager:1.0.0"
  api "androidx.lifecycle:lifecycle-runtime-ktx:2.2.0-rc02"
  api "androidx.lifecycle:lifecycle-extensions:$lifecycle_version"
  api "androidx.lifecycle:lifecycle-viewmodel-ktx:$lifecycle_version"

  // Play Core
  implementation "com.google.android.play:core:1.6.4"

  // Anko
  api "org.jetbrains.anko:anko-commons:0.10.8"

  // Third party
  api "com.jakewharton.timber:timber:4.7.1"
}

publish
{
  userOrg = "hagergroup"
  repoName = "Maven"
  groupId = "com.hagergroup"
  artifactId = "sweet-potato"
  publishVersion = android.defaultConfig.versionName
  desc = "Sweet Potato is the Android framework from Hager Group mainly written in Kotlin and only compatible with Android Jetpack.It provides a light-weight wrapper around Android components that contains everyting you need!"
  website = "https://github.com/hagergroup/sweet-potato-android"
}

uploadArchives
{
  repositories
  {
    mavenDeployer
    {
      snapshotRepository(url: findProperty("azureArtifactsUrl") ?: "")
      {
        authentication(userName: findProperty("azureArtifactsUsername") ?: "", password: findProperty("azureArtifactsGradleAccessToken") ?: "")
      }

      pom.project
      {
        name "Sweet Potato"
        groupId "com.hagergroup"
        artifactId "sweet-potato"
        version android.defaultConfig.versionName
        packaging "aar"
      }
    }
  }
}